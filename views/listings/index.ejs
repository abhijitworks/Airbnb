<% layout("/layouts/boilerplate") %>

<div class="container py-5">
  <h1 class="mb-4 text-center fw-bold">All Listings</h1>

  <div class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-4">
    <% for (let listing of allListings) { %>
    <div class="col">
      <div class="card h-100 shadow-sm rounded-4 overflow-hidden">
        <% if (listing.image && listing.image.url) { %>
        <img
          src="<%= listing.image.url %>"
          class="card-img-top img-fluid"
          alt="<%= listing.title %>"
          style="height: 200px; object-fit: cover"
        />
        <% } else { %>
        <img
          src="/images/default-listing.jpg"
          class="card-img-top img-fluid"
          alt="default listing image"
          style="height: 200px; object-fit: cover"
        />
        <% } %>
        <div class="card-body d-flex flex-column">
          <h5 class="card-title fw-bold"><%= listing.title %></h5>
          <p class="card-text text-truncate" title="<%= listing.description %>">
            <%= listing.description %>
          </p>
          <p class="card-text text-primary fw-semibold">
            â‚¹<%= listing.price.toLocaleString("en-IN") %>
          </p>
          <p class="card-text">
            <small class="text-muted"><%= listing.location %></small>
          </p>
          <div class="mt-auto">
            <a
              href="/listings/<%= listing._id %>"
              class="btn btn-danger w-100 fw-bold"
            >
              View Details
            </a>
          </div>
        </div>
      </div>
    </div>
    <% } %>
  </div>
</div>
